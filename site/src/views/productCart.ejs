<%- include('partials/head.ejs') %>

<body>
    <!-- Header -->
    <%- include('partials/header.ejs') %>
    <!--=============================
    =            Content            =
    ==============================-->
    <main class="mainProductCart">
        <!-- CUERPO DEL CARRITO-->
        <div class="container">

            <!-- FORMULARIO  -->
            <article>
                <div class="encabezado">
                    <h5 class="titleSection card-header text-center my-3"><%= title %></h5>
               
                  
                    <%if (totalProductoEnCarrito<=0 || totalProductoEnCarrito== "" || totalProductoEnCarrito==undefined){ %> 
                        
                        <h4 style="height: 56vh;">No hay productos agregados a su carrito</h4>
                        <div class="my-2 accion  col-md-4 col-lg-4">
                            <a href="/products"><button class="botones btn btn-outline-dark" type="button">SEGUIR
                                    COMPRANDO</button></a>
                        </div>
                    
                    <%}else{ %> 
            
                <div id="paginacion">
                    
                    <span class="derecha"><img src="\img\compra-segura.png" alt="">Compra protegida</span>
                </div>
            </div>

            <!--PRODUCTO SELECCIONADO, DESCRIPCION, CANTIDAD DE UNIDADES y PRECIO -->
            
            <h4>Productos seleccionados</h4>
            <div class="row col-12" id="column"><!-- contenedor columnas -->
                <div class="col-3">
                    <h4 style="border-right: 1px solid black; padding-right: 20px;">Producto</h4>
                </div>

                <div class="col-8 row">
                    <div class="col-6">
                        <h4 >Nombre</h4>
                    </div>
                    <div class="col-2">
                        <h4 >Precio </h4>
                    </div>
                    <div class="col-2">
                        <h4 >Cantidad</h4>
                    </div>
                    <div class="col-2">
                        <h4 >Total</h4>
                    </div>
                </div>
                <div class="col-1">
                    <h4 >Eliminar</h4>
                </div>

            </div>
            
            <% productoEnCarrito.forEach(producto => { %>
                <% if (producto.id_user == user.id ) { %>
            <div class="producto">
            
                <div class="codigo col-12" style="padding: 5px 0;"><!-- contendeor filas detalle de compra -->
                    <!-- IMAGEN PROD-->
                    <div class="imagen col-3  col-md-2 " style="align-items: center;">
                       
                        <img src="/img/products/<%- producto.productos.imagenes %> ">
                    </div>
                    
                    <div class="row col-8 col-md-9" style="padding-left: 30px;">
                        <!-- NOMBRE PROD -->
                        <div class="card col-12 col-md-6" style="align-items: center;">
                            <div class="card-body">
                                <%- producto.productos.nombre %>
                            </div>
                        </div>
                        <!-- PRECIO PROD -->
                        <div class="cantidad-precio col-12 col-md-2" style="align-items: center;">
                            <div class="precio">
                                <span><span>$</span><%- producto.productos.precio %> </span>
                            </div>
                        </div>
                        <!-- CANTIDAD PROD -->
                        <div class="cantidad-precio col-12 col-md-2" style="align-items: center;">
                            <div class="precio">    
                                <span><%- producto.cantidad %> </span>
                            </div>
                        </div>
                        <!-- SUMA TOTAL DE LA CANTIDAD DEL PRODUCTO -->
                        <div class="cantidad-precio col-12 col-md-2" style="align-items: center; padding: 0;">
                            <div class="precio" >
                                <span><span>$</span><%- (producto.productos.precio)*(producto.cantidad) %>  </span>
                            </div>
                        </div>
                    </div>
                
                    
                    
                    <form action="/products/retiraDelCarrito/<%= producto.id %>?_method=PUT" method="POST"
                        enctype="multipart/form-data" class="col-1" style="margin: auto 0; padding: 0;">
                        <button class="tachito" style="font-size: 2em;margin: 0;" type="submit"><i class="fa fa-trash" style="color: red;"></i></button>
                    </form>

                </div>
                <% }}) %><!-- fin detalle de compra  -->
            </div>

            <div class="row total"><!-- contenedor suma de procutos y precio -->
                <!-- total de productos -->
                <div class="col-12 row"  style="justify-content: flex-end;">
                    <h4>total item : </h4> <span> <%= totalProductoEnCarrito %> </span>
                </div>
                <!-- precio total -->
                <div class="col-12 row"  style="justify-content: flex-end;">
                    <h4>TOTAL A PAGAR :</h4>  <span> <%= precioTotal %> </span>
                </div>
            </div>

            <!-- METODOS DE PAGO, CODIGO DESCUENTO Y  METODO DE ENVIO-->
            <div class="container">
                <div class="pago-envio col-12 ">
                    <div class=" col-md-4 col-lg-4" style="text-align: center">
                        <h5>Metodo de pago</h5>
                        <div class="input">
                            <select class="custom-select" id="" aria-label="">
                                <option value="1">Efectivo</option>
                                <option value="2">Tarjeta de credito</option>
                                <option value="3">Transferencia</option>
                                <option value="4">Pago QR</option>
                                <option value="5">Mercado Pago</option>
                            </select>
                        </div>
                    </div>
                    <div class=" col-md-4 col-lg-4" style="text-align: center">
                        <h5>Codigo de descuento</h5>
                        <div class="">
                            <label><input type="text-number"></label>
                        </div>
                    </div>
                    <div class=" col-md-4 col-lg-4" style="text-align: center">
                        <h5>Metodo de envio</h5>
                        <div class="input">
                            <select class="custom-select" id="" aria-label="">
                                <option value="Re">Retira en local</option>
                                <option value="Co">Correo</option>
                                <option value="Mo">Motomensajeria</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- CAJA DE BOTONES (FINALIZAR COMPRA-AGREGAR PRODUCTO-VACIAR CARRITO)-->
                <div class="botonesAccion">
                    <div class="my-2 accion col-md-4 col-lg-4">
                        <form action="/products/cart/confirm?_method=PUT" method="POST">
                            <a href="/products/cart/confirm"><button class="botones btn btn-outline-dark" type="submit">FINALIZAR
                                COMPRA</button></a>
                        </form>
                      
                    </div>
                    <div class="my-2 accion  col-md-4 col-lg-4">
                        <a href="/products"><button class="botones btn btn-outline-dark" type="button">SEGUIR
                                COMPRANDO</button></a>
                    </div>
                    <form action="/products/deleteAllCarrito?_method=PUT" method="POST">
                        <div class="my-2 accion  col-md-4 col-lg-4">

                            <button class="botones btn btn-outline-dark" type="submit" >VACIAR
                                CARRITO</button>
                        </div>
                    </form>
                </div>
            </div> 

            <%} %> 
           
                    <!-- SECCIÃ“N CAROUSEL -->

    </main>
    <!--====  End of Content  ====-->

    <!-- footer -->
    <%- include('partials/footer.ejs') %>
    <!-- scripts -->
    <%- include('partials/scripts.ejs') %>
</body>

</html>